<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NGS file formats &#8212; Bioinformatics at COMAV 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Read QA and Cleaning" href="read_cleaning.html" />
    <link rel="prev" title="Command line primer" href="cmd_primer.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ngs-file-formats">
<h1>NGS file formats<a class="headerlink" href="#ngs-file-formats" title="Link to this heading">¶</a></h1>
<p>There are lots of file formats related to NGS analyses.
The most common ones are:</p>
<a class="reference internal image-reference" href="_images/ngs_map_read_file_formats.png"><img alt="_images/ngs_map_read_file_formats.png" src="_images/ngs_map_read_file_formats.png" style="width: 650px;" />
</a>
<a class="reference internal image-reference" href="_images/ngs_file_formats.png"><img alt="_images/ngs_file_formats.png" src="_images/ngs_file_formats.png" style="width: 650px;" />
</a>
<section id="sequence-file-formats">
<h2>Sequence file formats<a class="headerlink" href="#sequence-file-formats" title="Link to this heading">¶</a></h2>
<p>The different sequence related formats include different information about the sequence.
The most common file formats in the NGS world are: fastq and sff.</p>
</section>
<section id="sff">
<h2>SFF<a class="headerlink" href="#sff" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="http://www.ncbi.nlm.nih.gov/Traces/trace.cgi?cmd=show&amp;f=formats&amp;m=doc&amp;s=format#sff">SFF</a> (Standard Flowgram Format) files are the 454 equivalent to the ABI chromatogram files.
They hold information about:</p>
<blockquote>
<div><ul class="simple">
<li><p>the flowgram,</p></li>
<li><p>the called sequence,</p></li>
<li><p>the qualities,</p></li>
<li><p>and the recommended quality and adaptor clipping.</p></li>
</ul>
</div></blockquote>
<p>These recommended clippings are given by the 454 sequencer.
The Roche software takes into account the quality and the adaptor sequence to recommend a clipping for each sequence.
Like the ABI files, these are binary files that should be opened with specialized programs.
There are several tools to extract the sequences and to convert them to a more usable format.
Roche provides one executable able to do it with the 454 machine.
Alternatively we can use the <a class="reference external" href="http://bioinf.comav.upv.es/sff_extract/index.html">sff_extract</a> tool to obtain a fasta file.</p>
</section>
<section id="fasta">
<h2>Fasta<a class="headerlink" href="#fasta" title="Link to this heading">¶</a></h2>
<p>The fasta format is based on a simple text.
Each sequence starts with a “&gt;” followed by the sequence name, an space and, optionally, the description</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">seq_1</span> <span class="n">description</span>
<span class="n">GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT</span>
<span class="o">&gt;</span><span class="n">seq_2</span>
<span class="n">ATCGTAGTCTAGTCTATGCTAGTGCGATGCTAGTGCTAGTCGTATGCATGGCTATGTGTG</span>
</pre></div>
</div>
<p>Usually, if we have quality information, another fasta file with the quality information could be provided.
In this cases both the sequence and the quality file should have the sequences in the same order.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">seq_1</span> <span class="n">description</span>
<span class="mi">54</span> <span class="mi">57</span> <span class="mi">54</span> <span class="mi">57</span> <span class="mi">48</span> <span class="mi">48</span> <span class="mi">48</span> <span class="mi">48</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">47</span> <span class="mi">47</span> <span class="mi">41</span> <span class="mi">42</span> <span class="mi">41</span> <span class="mi">47</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">47</span> <span class="mi">44</span> <span class="mi">44</span> <span class="mi">44</span> <span class="mi">44</span> <span class="mi">50</span> <span class="mi">50</span>
<span class="mi">54</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">46</span> <span class="mi">43</span> <span class="mi">37</span> <span class="mi">44</span> <span class="mi">43</span> <span class="mi">57</span> <span class="mi">37</span> <span class="mi">37</span> <span class="mi">37</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">52</span> <span class="mi">52</span> <span class="mi">52</span> <span class="mi">52</span> <span class="mi">57</span> <span class="mi">50</span> <span class="mi">47</span> <span class="mi">47</span> <span class="mi">52</span>
<span class="o">&gt;</span><span class="n">seq_2</span>
<span class="mi">52</span> <span class="mi">47</span> <span class="mi">52</span> <span class="mi">52</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">50</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">54</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">46</span> <span class="mi">46</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span>
<span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">57</span> <span class="mi">29</span> <span class="mi">29</span>
</pre></div>
</div>
</section>
<section id="sanger-fastq">
<h2>sanger fastq<a class="headerlink" href="#sanger-fastq" title="Link to this heading">¶</a></h2>
<p>The <a class="reference external" href="http://en.wikipedia.org/wiki/FASTQ_format">fastq</a> format was developed to provide a convenient way of storing the sequence and the quality scores in the same file.
These are text files and they look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>@seq_1
GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT
+
!&#39;&#39;*((((***+))%%%++)(%%%%).1***-+*&#39;&#39;))**55CCF&gt;&gt;&gt;&gt;&gt;&gt;CCCCCCC65
@seq_2
ATCGTAGTCTAGTCTATGCTAGTGCGATGCTAGTGCTAGTCGTATGCATGGCTATGTGTG
+
208DA8308AD8SF83FH0SD8F08APFIDJFN34JW830UDS8UFDSADPFIJ3N8DAA
</pre></div>
</div>
<p>In this file every sequence has 4 lines.
In the first line we get the sequence name after the symbol “&#64;” and, optionally, the description.
The second line has the sequence and the fourth line has the quality scores encoded as letters.</p>
<p>Quality coding (modified from wikipedia).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS......................
..........................XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX......................
...............................IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII......................
!&quot;#$%&amp;&#39;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~
|                         |    |        |                              |                     |
33                        59   64       73                            104                   126

S - Sanger        Phred+33,  raw reads typically (0, 40)
X - Solexa        Solexa+64, raw reads typically (-5, 40)
I - Illumina      Phred+64,  raw reads typically (0, 40)
</pre></div>
</div>
</section>
<section id="illummina-fastq">
<h2>Illummina fastq<a class="headerlink" href="#illummina-fastq" title="Link to this heading">¶</a></h2>
<p>This file is almost identical to a sanger fastq file, but the encoding for the quality scores is different.
When we deal with a fastq file we have to be sure about which kind of file we are dealing with, an illumina fastq or a sanger fastq. Unfortunately they are not easy to differentiate.
Also you have to take into account that solexa used to had a third fastq format, the solexa fastq, although this one is mostly obsoleted.
Recently Illumina has also decided to distribute its files as Sanger fastq, so the Illumina fastq will be not used any more.</p>
<p>One of the seq_crumbs utilities, guess_seq_format, is able to differentiate the Sanger from the Illumina version by looking for quality characters exclusive of the Sanger version.</p>
</section>
<section id="sra">
<h2>SRA<a class="headerlink" href="#sra" title="Link to this heading">¶</a></h2>
<p>SRA is the file format in which all <a class="reference external" href="http://www.ncbi.nlm.nih.gov/sra">NCBI SRA</a> content is provided.
SRA files are binary files and we need specific tools to extract the information.
There is a toolkit (<a class="reference external" href="https://github.com/ncbi/sra-tools">SRA Toolkit</a>)developed by NCBI to deal with these binary files.</p>
</section>
<section id="compressed-files">
<h2>Compressed files<a class="headerlink" href="#compressed-files" title="Link to this heading">¶</a></h2>
<p>Sometime these sequence text file can be found compressed to save up hard drive space.
The most common compression formats are <a class="reference external" href="http://en.wikipedia.org/wiki/Gzip">gzip</a> and <a class="reference external" href="http://samtools.sourceforge.net/tabix.shtml">bgzip</a>.
bgzip is a gzip variant commonly used in genomics because, although it is a little less efficient in the compression ratio, it allows random access.
Most software is becoming compatible with these formats.</p>
</section>
<section id="paired-files">
<h2>Paired files<a class="headerlink" href="#paired-files" title="Link to this heading">¶</a></h2>
<p>It is common to obtain two reads from a single molecule.
Examples of these techniques are the Illumina pair-ends and mate-pairs.
In this cases for each read there is another paired read.
One common way to store those paired reads is to create to fastq files, one for the first read of the pairs and another one for the second.
In this case the files should hold the reads exactly in the same order.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fastq</span> <span class="n">file</span> <span class="mi">1</span>
<span class="nd">@molecule_1</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>
<span class="nd">@molecule_2</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>
<span class="nd">@molecule_3</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>

<span class="n">Fastq</span> <span class="n">file</span> <span class="mi">2</span>
<span class="nd">@molecule_1</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
<span class="nd">@molecule_2</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
<span class="nd">@molecule_3</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
</pre></div>
</div>
<p>Another option is to interleave the reads in a single file alternating the first and second read for each pair.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interleaved</span> <span class="n">Fastq</span> <span class="n">file</span>
<span class="nd">@molecule_1</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>
<span class="nd">@molecule_1</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
<span class="nd">@molecule_2</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>
<span class="nd">@molecule_2</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
<span class="nd">@molecule_3</span> <span class="mi">1</span><span class="n">st_read_from_pair</span>
<span class="nd">@molecule_3</span> <span class="mi">2</span><span class="n">nd_read_from_pair</span>
</pre></div>
</div>
<p>Depending on the software that we want to use we should the interleaved or the two file version; but most of actual ones use the one file version.</p>
<section id="id2">
<h3>SRA toolkit<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>Download the <a class="reference external" href="https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR2970642/SRR2970642">sra file</a> <a class="reference external" href="https://www.ncbi.nlm.nih.gov/sra/SRX1460040">(file info)</a> and use fastq-dump to convert to fastq format.</p>
<p>First, you can run the program with the default options and look at the output file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ngs_user@ngsmachine:~$ fastq-dump SRR2970642
</pre></div>
</div>
<p>Depending on the software that we want to use we should the interleaved or the two file version; but most of actual ones use the one file version.</p>
<p>Is this useful? Taking into account that the reads are paired reads, can we improve the conversion?:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ngs_user@ngsmachine:~$ fastq-dump --split-files --defline-qual &quot;+&quot; --defline-seq &#39;@$sn/$ri&#39; --gzip SRR2970642
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/comav.png" alt="Logo of Bioinformatics at COMAV"/>
            </a></p>
<h1 class="logo"><a href="index.html">Bioinformatics at COMAV</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="sequencing_technologies.html">Sequencing technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="ngs_applications_examples.html">NGS application examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence_analysis_software.html">NGS analysis software</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmd_primer.html">Command line primer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NGS sequence file formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="read_cleaning.html">NGS read cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">Sequence assembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="mapping.html">Sequence mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="snp_calling.html">SNP calling and filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnaseq.html">NGS expression analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="rnaseq.html#practical-tasks">Practical tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="text_files.html">Dealing with big result files</a></li>
<li class="toctree-l1"><a class="reference internal" href="bedtools.html">BEDTools</a></li>
<li class="toctree-l1"><a class="reference internal" href="final_practice.html">Final practice</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="cmd_primer.html" title="previous chapter">Command line primer</a></li>
      <li>Next: <a href="read_cleaning.html" title="next chapter">Read QA and Cleaning</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2010, Jose Blanca & Joaquin Cañizares.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>
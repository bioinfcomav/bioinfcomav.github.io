
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Assembly &mdash; Bioinformatics at COMAV 0.1 documentation</title>
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Bioinformatics at COMAV 0.1 documentation" href="../index.html" />
    <link rel="prev" title="Phylogeny" href="phylogeny.html" /> 
  </head>
  <body>

<div class="body">
    <header>
        <h1><a href="index.html">Bioinformatics at COMAV</a></h1>
    </header>


    <nav class="horizontal_nav page_nav">
        <ul>
            <li><a href="index.html">Bioinformatics & genomics</a>
                <ul>
                    <li><a href="/services.html">Services</a></li>
                    <li><a href="/people.html">People</a></li>
                    <li><a href="/publications.html">Publications</a></li>
                    <li><a href="/getting_here.html">Getting here</a></li>
<!--                    <li><a href="http://bioinf.comav.upv.es/notes/">Wiki</a></li>-->
               </ul>
            </li>
            <li><a href="/software.html">Software</a>
                <ul>
                    <li><a href="https://github.com/bioinfcomav/">Bioinf COMAV</a></li>
                    <li><a href="https://github.com/JoseBlanca/">Jose Blanca</a></li>
                    <!--
                    <li><a href="/seq_crumbs/index.html">seq_crumbs</a></li>
                    <li><a href="/ngs_backbone/index.html">ngs_backbone</a></li>
                    <li><a href="/clean_reads/index.html">clean_reads</a></li>
                    <li><a href="/sff_extract/index.html">sff_extract</a></li>
                    <li><a href="/psubprocess/index.html">psubprocess</a></li>-->
               </ul>
            </li>
            <li><a href="/courses.html">Courses</a>
                <ul>
                    <li><a href="/courses/intro_bioinf/index.html">Bionformática básica</a></li>
                    <li><a href="/courses/sequence_analysis/index.html">NGS sequence analysis</a></li>
                    <li><a href="/courses/linux/index.html">Linux y Python</a></li>
                    <li><a href="/courses/unix/index.html">Linux para Biologos</a></li>
               </ul>
        </ul>
    </nav>

    <main>
                
    
  <section id="assembly">
<h1>Assembly<a class="headerlink" href="#assembly" title="Permalink to this headline">¶</a></h1>
<section id="practica-de-ensamblaje">
<h2>Práctica de ensamblaje<a class="headerlink" href="#practica-de-ensamblaje" title="Permalink to this headline">¶</a></h2>
<section id="cromatogramas">
<h3>Cromatogramas<a class="headerlink" href="#cromatogramas" title="Permalink to this headline">¶</a></h3>
<p>La información obtenida en los secuenciadores automáticos se guarda en ficheros binarios.</p>
<p>Estos ficheros suelen incluir, además del cromatograma procesado (trace), la secuencia de nucleótidos obtenida y la calidad asociada a la misma.</p>
<p>Los secuenciadores Sanger de Applied generan los datos en formato abi.</p>
<p>Estos ficheros abi se pueden leer con distintos programas: chromas, el Sequence  Scanner (Win), FintchTV (Mac, PC, Linux) o el trev del paquete de análisis Staden (Mac, Pc, Linux).</p>
<p>El formato utilizado por el Staden para guardar los cromatogramas es el scf.</p>
<p>En el NCBI se pueden encontrar, por ejemplo en la sección EST, algunas secuencias que incluyen también el cromatograma original.</p>
</section>
<section id="analisis-de-cromatogramas-con-el-trev">
<h3>Análisis de cromatogramas con el Trev<a class="headerlink" href="#analisis-de-cromatogramas-con-el-trev" title="Permalink to this headline">¶</a></h3>
<p>Descargar los el fichero cromprimido de cromatogramas de <a class="reference download internal" download="" href="../_downloads/5115d381a02e58a698d9620e2766b78f/cromatogramas.zip"><code class="xref download docutils literal notranslate"><span class="pre">ejemplo</span></code></a>.</p>
<p>Abrir los cromatogramas que habíamos descargado con el trev de uno en uno y comprobar su calidad.
El trev denomina a la calidad confidence.
Conviene pedir al trev que marque la calidad de la asignación de cada base (view -&gt; display confidence).</p>
<p>Marcar las regiones de mala calidad del principio y el final de las secuencias (edit -&gt; left quality, edit -&gt; right quality).</p>
<p>Evaluar para cada un de ellos:</p>
<ul class="simple">
<li><p>¿Tiene señal? ¿Se ven bandas o es todo ruido?</p></li>
<li><p>¿Dónde comienza la región de buena calidad? ¿Dónde termina?</p></li>
<li><p>¿Acaba la región de mala calidad de forma brusca?</p></li>
<li><p>Posible diagnóstico de los problemas.</p></li>
<li><p>¿Hay bases mal interpretadas por el basecaller?</p></li>
<li><p>¿Hay mucho ruido de fondo?</p></li>
<li><p>Guardar la secuencia obtenida en texto plano.</p></li>
</ul>
</section>
<section id="analisis-de-cromatogramas-automatico-con-el-pregap">
<h3>Análisis de cromatogramas automático con el pregap<a class="headerlink" href="#analisis-de-cromatogramas-automatico-con-el-pregap" title="Permalink to this headline">¶</a></h3>
<p>El PreGap puede analizar automáticamente la calidad y otros aspectos de los cromatogramas determinando las regiones de buena y mala calidad.</p>
<p>Reanalizar con el PreGap los cromatogramas anteriores.</p>
<p>El PreGap generará para cada archivo abi original un archivo de texto con extensión exp.
En este archivo exp incluirá la secuencia, la calidad y los puntos que delimitan las regiones de buena calidad y las regiones que se corresponden con vector.</p>
<p>Con el Trev abrir los ficheros analizados (.exp) y comparar los analisis manuales con el realizado por el PreGap.</p>
</section>
<section id="alineamiento-manual">
<h3>Alineamiento manual<a class="headerlink" href="#alineamiento-manual" title="Permalink to this headline">¶</a></h3>
<p>Usando el Openoffice draw realiza un alineamiento manual con estas <a class="reference download internal" download="" href="../_downloads/5ddb95f11b836fc32ebee0f051d1ee70/reads.odp"><code class="xref download docutils literal notranslate"><span class="pre">lecturas</span></code></a>.
Las letras y colores identifican secuencias similares en esa región. Obtén los contigs, pero recuerda que pueden aparecer problemas con el repetitivo, vectores, splicing alternativo, etc.</p>
<p>Cuando lo tengas compara con este <a class="reference download internal" download="" href="../_downloads/44c2c5ccc87802bc5efa90b60b01c7bf/manual_result.pdf"><code class="xref download docutils literal notranslate"><span class="pre">resultado</span></code></a>.</p>
</section>
<section id="ensamblaje-de-ests-1">
<h3>Ensamblaje de ESTs 1<a class="headerlink" href="#ensamblaje-de-ests-1" title="Permalink to this headline">¶</a></h3>
<p>Ahora vamos a realizar un proyecto de secuenciación a partir de varias lecturas generadas por Sanger.</p>
<p>Descargar los cromatogramas del fichero cromprimido <a class="reference download internal" download="" href="../_downloads/bae827702df53639ec03d7f58dc8c45c/secuencias1.zip"><code class="xref download docutils literal notranslate"><span class="pre">secuencias1</span></code></a>.</p>
<p>Preanalizar las secuencias con el PreGap y utilizar los ficheros producidos para crear el proyecto con el Gap4.</p>
<p>¿Cuántas secuencias se han introducido en la base de datos?</p>
<p>¿Cuántos contigs se han producido?. ¿De cuantas lecturas?</p>
<p>Ejecutar el editor de contigs y comprobar el contig producido, comprobar las incongruencias en las secuencias viendo los cromatogramas.</p>
<p>Practicar con las diferentes opciones y análisis del programa Gap4</p>
<p>Salvar los consensos en ficheros separados y en un único fichero</p>
</section>
<section id="ensamblaje-de-ests-2">
<h3>Ensamblaje de ESTs 2<a class="headerlink" href="#ensamblaje-de-ests-2" title="Permalink to this headline">¶</a></h3>
<p>Ahora vamos a realizar un proyecto de secuenciación a partir de lecturas de ESTs. Descargar el fichero comprimido <a class="reference download internal" download="" href="../_downloads/a061d695f2f221c315a1882efa716258/secuencias2.zip"><code class="xref download docutils literal notranslate"><span class="pre">secuencias2</span></code></a>.</p>
<p>Una vez hayais obtenido los contigs con el Gap4:</p>
<ul class="simple">
<li><p>Comprobar el número de contigs obtenido.</p></li>
<li><p>El número de secuencias por contigs</p></li>
<li><p>Buscar regiones similares en el interior del contig utilizando el análisis de Internal Join del Gap4.</p></li>
<li><p>¿Que sucede?.</p></li>
</ul>
<p>Editar alguna de los regiones encontradas.</p>
<ul class="simple">
<li><p>¿Por qué el Gap4 no junta esos contigs?.</p></li>
</ul>
<p>Repetir todo el análisis pero ahora incluyendo las opciones de búsqueda de adaptadores y vector del PreGap4.</p>
<ul class="simple">
<li><p>¿Cuantos contigs aparecen ahora?.</p></li>
<li><p>Comprueba si existen regiones similares internas y justifica su existencia</p></li>
</ul>
</section>
<section id="control-calidad-ensamblaje">
<h3>Control calidad ensamblaje<a class="headerlink" href="#control-calidad-ensamblaje" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://solgenomics.net/">SGN</a> ha secuenciado un borrador del genoma de <em>Nicotiana benthamiana</em>.</p>
<p>El método de secuenciación ha sido el siguiente:
A partir del ADN genómico, se han creado tres librerias para Illumina HiSeq-2000:</p>
<ul class="simple">
<li><p>una paired end con un tamaño de inserto de 500 pb aprox (4 líneas)</p></li>
<li><p>a mate-pair libreria con un tamaño de inserto de 2Kb (1 línea</p></li>
<li><p>a mate pair libreria con un tamaño de inserto de 5Kb (1 línea)</p></li>
</ul>
<p>Se muestran las estadśiticas que corresponden a dos ensamblados distintos realizados con el SOAPdenovo.</p>
<p>¿Cuál de los dos corresponder a la v0.3 y v0.42 del ensamblaje?</p>
<p>¿Cuál prefieres?</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Statistic</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sequence Count</p></td>
<td><p>3,010,735 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>Total Length</p></td>
<td><p>2462490758 bp</p></td>
</tr>
<tr class="row-even"><td><p>Longest sequence</p></td>
<td><p>208210 bp</p></td>
</tr>
<tr class="row-odd"><td><p>Shortest sequence</p></td>
<td><p>201 bp</p></td>
</tr>
<tr class="row-even"><td><p>Average length</p></td>
<td><p>5336.26 bp</p></td>
</tr>
<tr class="row-odd"><td><p>N95 length</p></td>
<td><p>1564 bp</p></td>
</tr>
<tr class="row-even"><td><p>N95 index</p></td>
<td><p>215459 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N90 length</p></td>
<td><p>3403 bp</p></td>
</tr>
<tr class="row-even"><td><p>N90 index</p></td>
<td><p>163811 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N75 length</p></td>
<td><p>8068 bp</p></td>
</tr>
<tr class="row-even"><td><p>N75 index</p></td>
<td><p>96046 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N50 length</p></td>
<td><p>16480 bp</p></td>
</tr>
<tr class="row-even"><td><p>N50 index</p></td>
<td><p>42984 sequences</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Statistic</p></th>
<th class="head"><p>Result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Sequence Count</p></td>
<td><p>461,463 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>Total Length</p></td>
<td><p>2899410662 bp</p></td>
</tr>
<tr class="row-even"><td><p>Longest sequence</p></td>
<td><p>103554 bp</p></td>
</tr>
<tr class="row-odd"><td><p>Shortest sequence</p></td>
<td><p>201 bp</p></td>
</tr>
<tr class="row-even"><td><p>Average length</p></td>
<td><p>963.02 bp</p></td>
</tr>
<tr class="row-odd"><td><p>N95 length</p></td>
<td><p>233 bp</p></td>
</tr>
<tr class="row-even"><td><p>N95 index</p></td>
<td><p>2338365 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N90 length</p></td>
<td><p>274 bp</p></td>
</tr>
<tr class="row-even"><td><p>N90 index</p></td>
<td><p>1763126 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N75 length</p></td>
<td><p>619 bp</p></td>
</tr>
<tr class="row-even"><td><p>N75 index</p></td>
<td><p>606395 sequences</p></td>
</tr>
<tr class="row-odd"><td><p>N50 length</p></td>
<td><p>4140 bp</p></td>
</tr>
<tr class="row-even"><td><p>N50 index</p></td>
<td><p>156329 sequences</p></td>
</tr>
</tbody>
</table>
</section>
<section id="comparacion-de-ensamblajes">
<h3>Comparación de ensamblajes<a class="headerlink" href="#comparacion-de-ensamblajes" title="Permalink to this headline">¶</a></h3>
<p>Se han utilizado varios ensambladores para ensamblar el cloroplasto de <em>N. benthamiana</em> (100Kb aprox).</p>
<p>Se utilizaron 883811 Illumina pair-ends de un tamaño de 101pb y un tamaño de inserto de 400bp (cobertura 1700X). El SOAPdenovo se utilizó con todas las secuencias y con solo un subconjunto de estas.</p>
<p>Los resultados del experimento realizado por el Dr Aureliano Bombarely fueron:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Assembler</p></th>
<th class="head"><p>Total Scaffold Size (Kb)</p></th>
<th class="head"><p>Number Scaffolds</p></th>
<th class="head"><p>Scaffold Max. Len (b)</p></th>
<th class="head"><p>Scaffold N50</p></th>
<th class="head"><p>Total Contig Size (Kb)</p></th>
<th class="head"><p>Number Contigs</p></th>
<th class="head"><p>Contig Max. Length (b)</p></th>
<th class="head"><p>Contigs N50</p></th>
<th class="head"><p>Running Time (min)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SOAP K63 cov &gt;255</p></td>
<td><p>1019</p></td>
<td><p>7712</p></td>
<td><p>1,395</p></td>
<td><p>127</p></td>
<td><p>1024</p></td>
<td><p>7790</p></td>
<td><p>547</p></td>
<td><p>127</p></td>
<td><p>4.75</p></td>
</tr>
<tr class="row-odd"><td><p>SOAP K63 subset</p></td>
<td><p>134</p></td>
<td><p>20</p></td>
<td><p>110,468</p></td>
<td><p>110,468</p></td>
<td><p>133</p></td>
<td><p>40</p></td>
<td><p>35,718</p></td>
<td><p>13,627</p></td>
<td><p>0.5</p></td>
</tr>
<tr class="row-even"><td><p>SOAP K63 subset + GapCloser</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>133</p></td>
<td><p>20</p></td>
<td><p>109,638</p></td>
<td><p>18,725</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>ABySS</p></td>
<td><p>170</p></td>
<td><p>25</p></td>
<td><p>61,293</p></td>
<td><p>37,547</p></td>
<td><p>170</p></td>
<td><p>28</p></td>
<td><p>57,534</p></td>
<td><p>37,547</p></td>
<td><p>20</p></td>
</tr>
<tr class="row-even"><td><p>Velvet</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>255</p></td>
<td><p>1138</p></td>
<td><p>2,445</p></td>
<td><p>215</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>Ray</p></td>
<td><p>1327</p></td>
<td><p>10418</p></td>
<td><p>45,896</p></td>
<td><p>116</p></td>
<td><p>1325</p></td>
<td><p>10423</p></td>
<td><p>45,896</p></td>
<td><p>116</p></td>
<td><p>20</p></td>
</tr>
</tbody>
</table>
<p>¿ Qué ensamblador utilizarías?</p>
</section>
</section>
</section>



        

    </main>

</div>
    <footer>
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/"><img alt="Licencia de Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br /><span xmlns:dct="https://purl.org/dc/terms/" property="dct:title">Bioinformatics at COMAV</span> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Reconocimiento 4.0 Internacional License</a>.
    </footer>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-16108274-1");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>